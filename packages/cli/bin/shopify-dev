#!/usr/bin/env node

const oclif = require('@oclif/core')
const Bugsnag = require('@bugsnag/js')

const path = require('path')
const project = path.join(__dirname, '..', 'tsconfig.json')

// In dev mode -> use ts-node and dev plugins
process.env.NODE_ENV = 'development'

require('ts-node').register({project})

// In dev mode, always show stack traces
oclif.settings.debug = true;

// Set up error tracking
Bugsnag.start({apiKey: "9e1e6889176fd0c795d5c659225e0fae", logger: null})

// Start the CLI
oclif.run().then(oclif.flush).catch((error) => {
  return new Promise((resolve, reject) => {
    Bugsnag.notify(error, null, resolve);
  }).then(oclif.Errors.handle(error));
})
